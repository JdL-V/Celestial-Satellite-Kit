function mu = mars_atm_mu(z)
    T = (-23.4 - 0.00222*z)*(z >= 7e3) + (-31 - 0.000998*z)*(z < 7e3);
    T = -170*(T < -170) + T*(T >= -170);
    S = 222;
    T0 = 273.15;
    mu0 = 1.37*10^(-5);
    T = T + 273.15;
    mu = mu0*(T/T0)^(3/2)*(T0+S)/(T+S);
end