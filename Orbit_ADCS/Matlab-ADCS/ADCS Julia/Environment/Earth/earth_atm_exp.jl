function earth_atm_exp(z::Vector{Float64})
    z0::Matrix{Float64} = vcat([0.00, 25.0, 30.0, 40.0, 
                                50.0, 60.0, 70.0, 80.0, 
                                90.0, 100., 110., 120.,
                                130., 140., 150., 180., 
                                200., 250., 300., 350., 
                                400., 450., 500., 600., 
                                700., 800., 900., 1000.]')*1e3;

    MZ = (z .>= z0)'
    sz = sum(MZ, dims=1)
    M2 = zeros(size(MZ))
    for ik = 1:size(MZ, 2)
        M2[maximum([sz[ik], 1]), ik] = 1
    end

    rho0::Matrix{Float64} = vcat([1.225, 3.899e-02, 1.774e-02, 3.972e-03, 
                            1.057e-03, 3.206e-04, 8.770e-05, 1.905e-05, 
                            3.396e-06, 5.297e-07, 9.661e-08, 2.438e-08, 
                            8.484e-09, 3.845e-09, 2.070e-09, 5.464e-10, 
                            2.789e-10, 7.248e-11, 2.418e-11, 9.518e-12, 
                            3.725e-12, 1.585e-12, 6.967e-13, 1.454e-13, 
                            3.614e-14, 1.170e-14, 5.245e-15, 3.019e-15]')*M2

    zs::Matrix{Float64} = vcat([7.249, 6.349, 6.682, 7.554, 
                            8.3820, 7.7140, 6.5490, 5.7990, 
                            5.3820, 5.8770, 7.2630, 9.4730, 
                            12.636, 16.149, 22.523, 29.740, 
                            37.105, 45.546, 53.628, 53.298, 
                            58.515, 60.828, 63.822, 71.835, 
                            88.667, 124.64, 181.05, 268.00]')*M2*1e3

    z0i::Matrix{Float64} = z0*M2
    
    rho::Matrix{Float64} = rho0.*exp.(-(z' .- z0i)./zs)
    return rho, rho0, zs, z0i 
end